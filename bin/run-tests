#!/usr/bin/env python3

import os.path
import subprocess
import shutil

SCRIPT_DIR = os.path.dirname(os.path.normpath(os.path.realpath(__file__)))
DOCKER_IMAGE_NAME = 'sshambir/compiler:0.0.1'

def compile(src_path: str, bin_path: str):
    cmd = [os.path.join(SCRIPT_DIR, 'pythonish'), src_path, '-o', bin_path]
    subprocess.check_call(cmd, cwd=SCRIPT_DIR)

def run(src_name: str):
    src_path = os.path.normpath(os.path.join(SCRIPT_DIR, '..', 'test', src_name))
    bin_path = os.path.normpath(os.path.join(SCRIPT_DIR, '..', 'test', 'out', os.path.splitext(src_name)[0]))
    compile(src_path, bin_path)

def main():
    run("first-space-velocity.txt")
    #run("if_branching.txt")
    #run("simple_strings_concat.txt")
    #run("square.txt")
    #run("advanced_strings_concat.txt")

if __name__ == "__main__":
    main()
